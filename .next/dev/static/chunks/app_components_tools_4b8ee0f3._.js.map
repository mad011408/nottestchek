{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/tools/FileToolsHandler.tsx"],"sourcesContent":["import { useMemo } from \"react\";\nimport { UIMessage } from \"@ai-sdk/react\";\nimport ToolBlock from \"@/components/ui/tool-block\";\nimport { FilePlus, FileText, FilePen, FileMinus } from \"lucide-react\";\nimport { useGlobalState } from \"../../contexts/GlobalState\";\nimport type { ChatStatus } from \"@/types\";\n\ninterface DiffDataPart {\n  type: \"data-diff\";\n  data: {\n    toolCallId: string;\n    filePath: string;\n    originalContent: string;\n    modifiedContent: string;\n  };\n}\n\ninterface FileToolsHandlerProps {\n  message: UIMessage;\n  part: any;\n  status: ChatStatus;\n}\n\nexport const FileToolsHandler = ({\n  message,\n  part,\n  status,\n}: FileToolsHandlerProps) => {\n  const { openSidebar } = useGlobalState();\n\n  // Extract diff data from data-diff parts in the message (streamed separately from tool result)\n  // This data only exists in memory/stream - not persisted, so on reload we just show the result message\n  const diffDataFromStream = useMemo(() => {\n    if (part.type !== \"tool-search_replace\") return null;\n\n    const diffPart = message.parts.find(\n      (p): p is DiffDataPart =>\n        p.type === \"data-diff\" &&\n        (p as DiffDataPart).data?.toolCallId === part.toolCallId,\n    );\n\n    return diffPart?.data || null;\n  }, [message.parts, part.type, part.toolCallId]);\n\n  const renderReadFileTool = () => {\n    const { toolCallId, state, input, output } = part;\n    const readInput = input as\n      | {\n          target_file: string;\n          offset?: number;\n          limit?: number;\n        }\n      | undefined;\n\n    const getFileRange = () => {\n      if (!readInput) return \"\";\n      if (readInput.offset && readInput.limit) {\n        return ` L${readInput.offset}-${readInput.offset + readInput.limit - 1}`;\n      }\n      if (!readInput.offset && readInput.limit) {\n        return ` L1-${readInput.limit}`;\n      }\n      if (readInput.offset && !readInput.limit) {\n        return ` L${readInput.offset}+`;\n      }\n      return \"\";\n    };\n\n    switch (state) {\n      case \"input-streaming\":\n        return status === \"streaming\" ? (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FileText />}\n            action=\"Reading file\"\n            isShimmer={true}\n          />\n        ) : null;\n      case \"input-available\":\n        return status === \"streaming\" ? (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FileText />}\n            action=\"Reading\"\n            target={\n              readInput\n                ? `${readInput.target_file}${getFileRange()}`\n                : undefined\n            }\n            isShimmer={true}\n          />\n        ) : null;\n      case \"output-available\": {\n        if (!readInput) return null;\n        const readOutput = output as { result: string };\n\n        const handleOpenInSidebar = () => {\n          const cleanContent = readOutput.result.replace(/^\\s*\\d+\\|/gm, \"\");\n          const range =\n            readInput.offset && readInput.limit\n              ? {\n                  start: readInput.offset,\n                  end: readInput.offset + readInput.limit - 1,\n                }\n              : undefined;\n\n          openSidebar({\n            path: readInput.target_file,\n            content: cleanContent,\n            range,\n            action: \"reading\",\n          });\n        };\n\n        const handleKeyDown = (e: React.KeyboardEvent) => {\n          if (e.key === \"Enter\" || e.key === \" \") {\n            e.preventDefault();\n            handleOpenInSidebar();\n          }\n        };\n\n        return (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FileText />}\n            action=\"Read\"\n            target={`${readInput.target_file}${getFileRange()}`}\n            isClickable={true}\n            onClick={handleOpenInSidebar}\n            onKeyDown={handleKeyDown}\n          />\n        );\n      }\n      default:\n        return null;\n    }\n  };\n\n  const renderWriteFileTool = () => {\n    const { toolCallId, state, input, output } = part;\n    const writeInput = input as\n      | {\n          file_path: string;\n          contents: string;\n        }\n      | undefined;\n\n    switch (state) {\n      case \"input-streaming\":\n        return status === \"streaming\" ? (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FilePlus />}\n            action=\"Creating file\"\n            isShimmer={true}\n          />\n        ) : null;\n      case \"input-available\":\n        return status === \"streaming\" ? (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FilePlus />}\n            action=\"Writing to\"\n            target={writeInput?.file_path}\n            isShimmer={true}\n          />\n        ) : null;\n      case \"output-available\":\n        if (!writeInput) return null;\n        return (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FilePlus />}\n            action=\"Successfully wrote\"\n            target={writeInput.file_path}\n            isClickable={true}\n            onClick={() => {\n              openSidebar({\n                path: writeInput.file_path,\n                content: writeInput.contents,\n                action: \"writing\",\n              });\n            }}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\" || e.key === \" \") {\n                e.preventDefault();\n                openSidebar({\n                  path: writeInput.file_path,\n                  content: writeInput.contents,\n                  action: \"writing\",\n                });\n              }\n            }}\n          />\n        );\n      default:\n        return null;\n    }\n  };\n\n  const renderDeleteFileTool = () => {\n    const { toolCallId, state, input, output } = part;\n    const deleteInput = input as\n      | {\n          target_file: string;\n          explanation: string;\n        }\n      | undefined;\n\n    switch (state) {\n      case \"input-streaming\":\n        return status === \"streaming\" ? (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FileMinus />}\n            action=\"Deleting file\"\n            isShimmer={true}\n          />\n        ) : null;\n      case \"input-available\":\n        return status === \"streaming\" ? (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FileMinus />}\n            action=\"Deleting\"\n            target={deleteInput?.target_file}\n            isShimmer={true}\n          />\n        ) : null;\n      case \"output-available\": {\n        if (!deleteInput) return null;\n        const deleteOutput = output as { result: string };\n        const isSuccess = deleteOutput.result.includes(\"Successfully deleted\");\n\n        return (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FileMinus />}\n            action={isSuccess ? \"Successfully deleted\" : \"Failed to delete\"}\n            target={deleteInput.target_file}\n          />\n        );\n      }\n      default:\n        return null;\n    }\n  };\n\n  const renderSearchReplaceTool = () => {\n    const { toolCallId, state, input, output } = part;\n    const searchReplaceInput = input as\n      | {\n          file_path: string;\n          old_string: string;\n          new_string: string;\n          replace_all?: boolean;\n        }\n      | undefined;\n\n    switch (state) {\n      case \"input-streaming\":\n        return status === \"streaming\" ? (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FilePen />}\n            action=\"Editing file\"\n            isShimmer={true}\n          />\n        ) : null;\n      case \"input-available\":\n        return status === \"streaming\" ? (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FilePen />}\n            action={\n              searchReplaceInput?.replace_all ? \"Replacing all in\" : \"Editing\"\n            }\n            target={searchReplaceInput?.file_path}\n            isShimmer={true}\n          />\n        ) : null;\n      case \"output-available\": {\n        if (!searchReplaceInput) return null;\n        const searchReplaceOutput = output as { result: string };\n        const isSuccess =\n          searchReplaceOutput.result.includes(\"Successfully made\");\n\n        const handleOpenInSidebar = () => {\n          // Use diff data from stream if available (not persisted across reloads)\n          openSidebar({\n            path: searchReplaceInput.file_path,\n            content:\n              diffDataFromStream?.modifiedContent || searchReplaceOutput.result,\n            action: \"editing\",\n            toolCallId,\n            originalContent: diffDataFromStream?.originalContent,\n            modifiedContent: diffDataFromStream?.modifiedContent,\n          });\n        };\n\n        const handleKeyDown = (e: React.KeyboardEvent) => {\n          if (e.key === \"Enter\" || e.key === \" \") {\n            e.preventDefault();\n            handleOpenInSidebar();\n          }\n        };\n\n        return (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FilePen />}\n            action={isSuccess ? \"Successfully edited\" : \"Failed to edit\"}\n            target={searchReplaceInput.file_path}\n            isClickable={true}\n            onClick={handleOpenInSidebar}\n            onKeyDown={handleKeyDown}\n          />\n        );\n      }\n      default:\n        return null;\n    }\n  };\n\n  const renderMultiEditTool = () => {\n    const { toolCallId, state, input, output } = part;\n    const multiEditInput = input as\n      | {\n          file_path: string;\n          edits: Array<{\n            old_string: string;\n            new_string: string;\n            replace_all?: boolean;\n          }>;\n        }\n      | undefined;\n\n    switch (state) {\n      case \"input-streaming\":\n        return status === \"streaming\" ? (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FilePen />}\n            action=\"Making multiple edits\"\n            isShimmer={true}\n          />\n        ) : null;\n      case \"input-available\":\n        return status === \"streaming\" ? (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FilePen />}\n            action={\n              multiEditInput\n                ? `Making ${multiEditInput.edits.length} edits to`\n                : \"Making edits\"\n            }\n            target={multiEditInput?.file_path}\n            isShimmer={true}\n          />\n        ) : null;\n      case \"output-available\": {\n        if (!multiEditInput) return null;\n        const multiEditOutput = output as { result: string };\n        const isSuccess = multiEditOutput.result.includes(\n          \"Successfully applied\",\n        );\n\n        return (\n          <ToolBlock\n            key={toolCallId}\n            icon={<FilePen />}\n            action={\n              isSuccess\n                ? `Successfully applied ${multiEditInput.edits.length} edits`\n                : \"Failed to apply edits\"\n            }\n            target={multiEditInput.file_path}\n          />\n        );\n      }\n      default:\n        return null;\n    }\n  };\n\n  // Main switch for file tool types\n  switch (part.type) {\n    case \"tool-read_file\":\n      return renderReadFileTool();\n    case \"tool-write_file\":\n      return renderWriteFileTool();\n    case \"tool-delete_file\":\n      return renderDeleteFileTool();\n    case \"tool-search_replace\":\n      return renderSearchReplaceTool();\n    case \"tool-multi_edit\":\n      return renderMultiEditTool();\n    default:\n      return null;\n  }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 419, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/tools/TerminalToolHandler.tsx"],"sourcesContent":["import React, { useEffect, useMemo } from \"react\";\nimport { UIMessage } from \"@ai-sdk/react\";\nimport { CommandResult } from \"@e2b/code-interpreter\";\nimport ToolBlock from \"@/components/ui/tool-block\";\nimport { Terminal } from \"lucide-react\";\nimport { useGlobalState } from \"../../contexts/GlobalState\";\nimport type { ChatStatus, SidebarTerminal } from \"@/types/chat\";\nimport { isSidebarTerminal } from \"@/types/chat\";\n\ninterface TerminalToolHandlerProps {\n  message: UIMessage;\n  part: any;\n  status: ChatStatus;\n}\n\nexport const TerminalToolHandler = ({\n  message,\n  part,\n  status,\n}: TerminalToolHandlerProps) => {\n  const { openSidebar, sidebarOpen, sidebarContent, updateSidebarContent } =\n    useGlobalState();\n  const { toolCallId, state, input, output, errorText } = part;\n  const terminalInput = input as {\n    command: string;\n    is_background: boolean;\n  };\n  const terminalOutput = output as {\n    result: CommandResult & { output?: string };\n  };\n\n  // Memoize streaming output computation\n  const streamingOutput = useMemo(() => {\n    const terminalDataParts = message.parts.filter(\n      (p) =>\n        p.type === \"data-terminal\" &&\n        (p as any).data?.toolCallId === toolCallId,\n    );\n    return terminalDataParts\n      .map((p) => (p as any).data?.terminal || \"\")\n      .join(\"\");\n  }, [message.parts, toolCallId]);\n\n  // Memoize final output computation\n  const finalOutput = useMemo(() => {\n    // Prefer new combined output format, fall back to legacy stdout+stderr for old messages\n    const newFormatOutput = terminalOutput?.result?.output ?? \"\";\n    const stdout = terminalOutput?.result?.stdout ?? \"\";\n    const stderr = terminalOutput?.result?.stderr ?? \"\";\n    const legacyOutput = stdout + stderr;\n\n    return (\n      newFormatOutput ||\n      legacyOutput ||\n      streamingOutput ||\n      (terminalOutput?.result?.error ?? \"\") ||\n      errorText ||\n      \"\"\n    );\n  }, [terminalOutput, streamingOutput, errorText]);\n\n  const isExecuting = state === \"input-available\" && status === \"streaming\";\n\n  const handleOpenInSidebar = () => {\n    if (!terminalInput?.command) return;\n\n    const sidebarTerminal: SidebarTerminal = {\n      command: terminalInput.command,\n      output: finalOutput,\n      isExecuting,\n      isBackground: terminalInput.is_background,\n      toolCallId: toolCallId,\n    };\n\n    openSidebar(sidebarTerminal);\n  };\n\n  // Track if this sidebar is currently active\n  const isSidebarActive =\n    sidebarOpen &&\n    sidebarContent &&\n    isSidebarTerminal(sidebarContent) &&\n    sidebarContent.toolCallId === toolCallId;\n\n  // Update sidebar content in real-time if it's currently open for this tool call\n  useEffect(() => {\n    if (!isSidebarActive) return;\n\n    updateSidebarContent({\n      output: finalOutput,\n      isExecuting,\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isSidebarActive, finalOutput, isExecuting]);\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" || e.key === \" \") {\n      e.preventDefault();\n      handleOpenInSidebar();\n    }\n  };\n\n  switch (state) {\n    case \"input-streaming\":\n      return status === \"streaming\" ? (\n        <ToolBlock\n          key={toolCallId}\n          icon={<Terminal />}\n          action=\"Generating command\"\n          isShimmer={true}\n        />\n      ) : null;\n    case \"input-available\":\n      return (\n        <ToolBlock\n          key={toolCallId}\n          icon={<Terminal />}\n          action={status === \"streaming\" ? \"Executing\" : \"Executed\"}\n          target={terminalInput?.command || \"\"}\n          isShimmer={status === \"streaming\"}\n          isClickable={true}\n          onClick={handleOpenInSidebar}\n          onKeyDown={handleKeyDown}\n        />\n      );\n    case \"output-available\":\n      return (\n        <ToolBlock\n          key={toolCallId}\n          icon={<Terminal />}\n          action=\"Executed\"\n          target={terminalInput?.command || \"\"}\n          isClickable={true}\n          onClick={handleOpenInSidebar}\n          onKeyDown={handleKeyDown}\n        />\n      );\n    case \"output-error\":\n      return (\n        <ToolBlock\n          key={toolCallId}\n          icon={<Terminal />}\n          action=\"Executed\"\n          target={terminalInput?.command || \"\"}\n          isClickable={true}\n          onClick={handleOpenInSidebar}\n          onKeyDown={handleKeyDown}\n        />\n      );\n    default:\n      return null;\n  }\n};\n"],"names":[],"mappings":";;;;;AAAA;AAGA;AACA;AACA;AAEA;;;;;;;;AAQO,MAAM,sBAAsB,CAAC,EAClC,OAAO,EACP,IAAI,EACJ,MAAM,EACmB;;IACzB,MAAM,EAAE,WAAW,EAAE,WAAW,EAAE,cAAc,EAAE,oBAAoB,EAAE,GACtE,IAAA,oJAAc;IAChB,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG;IACxD,MAAM,gBAAgB;IAItB,MAAM,iBAAiB;IAIvB,uCAAuC;IACvC,MAAM,kBAAkB,IAAA,uXAAO;wDAAC;YAC9B,MAAM,oBAAoB,QAAQ,KAAK,CAAC,MAAM;kFAC5C,CAAC,IACC,EAAE,IAAI,KAAK,mBACX,AAAC,EAAU,IAAI,EAAE,eAAe;;YAEpC,OAAO,kBACJ,GAAG;gEAAC,CAAC,IAAM,AAAC,EAAU,IAAI,EAAE,YAAY;+DACxC,IAAI,CAAC;QACV;uDAAG;QAAC,QAAQ,KAAK;QAAE;KAAW;IAE9B,mCAAmC;IACnC,MAAM,cAAc,IAAA,uXAAO;oDAAC;YAC1B,wFAAwF;YACxF,MAAM,kBAAkB,gBAAgB,QAAQ,UAAU;YAC1D,MAAM,SAAS,gBAAgB,QAAQ,UAAU;YACjD,MAAM,SAAS,gBAAgB,QAAQ,UAAU;YACjD,MAAM,eAAe,SAAS;YAE9B,OACE,mBACA,gBACA,mBACA,CAAC,gBAAgB,QAAQ,SAAS,EAAE,KACpC,aACA;QAEJ;mDAAG;QAAC;QAAgB;QAAiB;KAAU;IAE/C,MAAM,cAAc,UAAU,qBAAqB,WAAW;IAE9D,MAAM,sBAAsB;QAC1B,IAAI,CAAC,eAAe,SAAS;QAE7B,MAAM,kBAAmC;YACvC,SAAS,cAAc,OAAO;YAC9B,QAAQ;YACR;YACA,cAAc,cAAc,aAAa;YACzC,YAAY;QACd;QAEA,YAAY;IACd;IAEA,4CAA4C;IAC5C,MAAM,kBACJ,eACA,kBACA,IAAA,qIAAiB,EAAC,mBAClB,eAAe,UAAU,KAAK;IAEhC,gFAAgF;IAChF,IAAA,yXAAS;yCAAC;YACR,IAAI,CAAC,iBAAiB;YAEtB,qBAAqB;gBACnB,QAAQ;gBACR;YACF;QACA,uDAAuD;QACzD;wCAAG;QAAC;QAAiB;QAAa;KAAY;IAE9C,MAAM,gBAAgB,CAAC;QACrB,IAAI,EAAE,GAAG,KAAK,WAAW,EAAE,GAAG,KAAK,KAAK;YACtC,EAAE,cAAc;YAChB;QACF;IACF;IAEA,OAAQ;QACN,KAAK;YACH,OAAO,WAAW,4BAChB,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,6SAAQ;;;;;gBACf,QAAO;gBACP,WAAW;eAHN;;;;2DAKL;QACN,KAAK;YACH,qBACE,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,6SAAQ;;;;;gBACf,QAAQ,WAAW,cAAc,cAAc;gBAC/C,QAAQ,eAAe,WAAW;gBAClC,WAAW,WAAW;gBACtB,aAAa;gBACb,SAAS;gBACT,WAAW;eAPN;;;;;QAUX,KAAK;YACH,qBACE,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,6SAAQ;;;;;gBACf,QAAO;gBACP,QAAQ,eAAe,WAAW;gBAClC,aAAa;gBACb,SAAS;gBACT,WAAW;eANN;;;;;QASX,KAAK;YACH,qBACE,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,6SAAQ;;;;;gBACf,QAAO;gBACP,QAAQ,eAAe,WAAW;gBAClC,aAAa;gBACb,SAAS;gBACT,WAAW;eANN;;;;;QASX;YACE,OAAO;IACX;AACF;GAzIa;;QAMT,oJAAc;;;KANL"}},
    {"offset": {"line": 592, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/tools/PythonToolHandler.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useCallback } from \"react\";\nimport { UIMessage } from \"@ai-sdk/react\";\nimport ToolBlock from \"@/components/ui/tool-block\";\nimport { Code2 } from \"lucide-react\";\nimport { useGlobalState } from \"../../contexts/GlobalState\";\nimport type { ChatStatus, SidebarPython } from \"@/types/chat\";\nimport { isSidebarPython } from \"@/types/chat\";\n\ninterface PythonToolHandlerProps {\n  message: UIMessage;\n  part: any;\n  status: ChatStatus;\n}\n\nexport const PythonToolHandler = ({\n  message,\n  part,\n  status,\n}: PythonToolHandlerProps) => {\n  const { openSidebar, sidebarOpen, sidebarContent, updateSidebarContent } =\n    useGlobalState();\n  const { toolCallId, state, input, output, errorText } = part;\n  const pythonInput = input as { code: string };\n  const pythonOutput = output as {\n    result: {\n      output?: string; // New combined output format\n      stdout?: string; // Legacy support\n      stderr?: string; // Legacy support\n      results?: any[];\n      exitCode?: number | null;\n      error?: string;\n    };\n    files?: Array<{ path: string }>;\n    // Legacy support for old messages\n    fileUrls?: Array<{ path: string; downloadUrl?: string }>;\n  };\n\n  const codePreview = pythonInput?.code || \"\";\n\n  // Memoize streaming output computation\n  const streamingOutput = useMemo(() => {\n    const pythonDataParts = message.parts.filter(\n      (p) =>\n        p.type === \"data-python\" && (p as any).data?.toolCallId === toolCallId,\n    );\n    return pythonDataParts.map((p) => (p as any).data?.terminal || \"\").join(\"\");\n  }, [message.parts, toolCallId]);\n\n  // Memoize final output computation\n  const finalOutput = useMemo(() => {\n    // Prefer new combined output format\n    const newFormatOutput = pythonOutput?.result?.output ?? \"\";\n\n    // Fall back to legacy stdout+stderr for old messages\n    const stdout = pythonOutput?.result?.stdout ?? \"\";\n    const stderr = pythonOutput?.result?.stderr ?? \"\";\n    const legacyOutput = stdout + stderr;\n\n    return (\n      newFormatOutput ||\n      legacyOutput ||\n      streamingOutput ||\n      (pythonOutput?.result?.error ?? \"\") ||\n      errorText ||\n      \"\"\n    );\n  }, [pythonOutput, streamingOutput, errorText]);\n\n  const isExecuting = state === \"input-available\" && status === \"streaming\";\n\n  const handleOpenInSidebar = useCallback(() => {\n    if (!pythonInput?.code) return;\n\n    const sidebarPython: SidebarPython = {\n      code: pythonInput.code,\n      output: finalOutput,\n      isExecuting,\n      toolCallId,\n    };\n\n    openSidebar(sidebarPython);\n  }, [pythonInput?.code, finalOutput, isExecuting, toolCallId, openSidebar]);\n\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      if (e.key === \"Enter\" || e.key === \" \") {\n        e.preventDefault();\n        handleOpenInSidebar();\n      }\n    },\n    [handleOpenInSidebar],\n  );\n\n  // Track if this sidebar is currently active\n  const isSidebarActive =\n    sidebarOpen &&\n    sidebarContent &&\n    isSidebarPython(sidebarContent) &&\n    sidebarContent.toolCallId === toolCallId;\n\n  // Update sidebar content in real-time if it's currently open for this tool call\n  useEffect(() => {\n    if (!isSidebarActive) return;\n\n    updateSidebarContent({\n      code: codePreview,\n      output: finalOutput,\n      isExecuting,\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isSidebarActive, codePreview, finalOutput, isExecuting]);\n\n  switch (state) {\n    case \"input-streaming\":\n      return status === \"streaming\" ? (\n        <ToolBlock\n          key={toolCallId}\n          icon={<Code2 />}\n          action=\"Generating Python code\"\n          target={codePreview}\n          isShimmer={true}\n          isClickable={true}\n          onClick={handleOpenInSidebar}\n          onKeyDown={handleKeyDown}\n        />\n      ) : null;\n    case \"input-available\":\n      return (\n        <ToolBlock\n          key={toolCallId}\n          icon={<Code2 />}\n          action={\n            status === \"streaming\" ? \"Executing Python\" : \"Executed Python\"\n          }\n          target={codePreview}\n          isShimmer={status === \"streaming\"}\n          isClickable={true}\n          onClick={handleOpenInSidebar}\n          onKeyDown={handleKeyDown}\n        />\n      );\n    case \"output-available\":\n      return (\n        <ToolBlock\n          key={toolCallId}\n          icon={<Code2 />}\n          action=\"Executed Python\"\n          target={codePreview}\n          isClickable={true}\n          onClick={handleOpenInSidebar}\n          onKeyDown={handleKeyDown}\n        />\n      );\n    case \"output-error\":\n      return (\n        <ToolBlock\n          key={toolCallId}\n          icon={<Code2 />}\n          action=\"Executed Python\"\n          target={codePreview}\n          isClickable={true}\n          onClick={handleOpenInSidebar}\n          onKeyDown={handleKeyDown}\n        />\n      );\n    default:\n      return null;\n  }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 784, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/tools/WebToolHandler.tsx"],"sourcesContent":["import ToolBlock from \"@/components/ui/tool-block\";\nimport { Search, ExternalLink } from \"lucide-react\";\nimport type { ChatStatus } from \"@/types\";\n\ninterface WebToolHandlerProps {\n  part: any;\n  status: ChatStatus;\n}\n\nexport const WebToolHandler = ({ part, status }: WebToolHandlerProps) => {\n  const { toolCallId, state, input } = part;\n\n  // Handle both new web tool format and legacy web_search format\n  const webInput = input as\n    | {\n        command?: \"search\" | \"open_url\";\n        query?: string;\n        url?: string;\n        explanation?: string;\n      }\n    | undefined;\n\n  // Determine tool type - for backward compatibility: if no command, assume it's a search (legacy web_search)\n  const isUrlCommand = webInput?.command === \"open_url\";\n\n  const getIcon = () => {\n    return isUrlCommand ? <ExternalLink /> : <Search />;\n  };\n\n  const getAction = (isCompleted = false) => {\n    const action = isUrlCommand ? \"Opening URL\" : \"Searching web\";\n    return isCompleted ? action.replace(\"ing\", \"ed\") : action;\n  };\n\n  const getTarget = () => {\n    if (!webInput) return undefined;\n    return isUrlCommand ? webInput.url : webInput.query;\n  };\n\n  switch (state) {\n    case \"input-streaming\":\n      return status === \"streaming\" ? (\n        <ToolBlock\n          key={toolCallId}\n          icon={getIcon()}\n          action={getAction()}\n          isShimmer={true}\n        />\n      ) : null;\n\n    case \"input-available\":\n      return status === \"streaming\" ? (\n        <ToolBlock\n          key={toolCallId}\n          icon={getIcon()}\n          action={getAction()}\n          target={getTarget()}\n          isShimmer={true}\n        />\n      ) : null;\n\n    case \"output-available\":\n      return (\n        <ToolBlock\n          key={toolCallId}\n          icon={getIcon()}\n          action={getAction(true)}\n          target={getTarget()}\n        />\n      );\n\n    default:\n      return null;\n  }\n};\n\n// Keep the old export for backward compatibility\nexport const WebSearchToolHandler = WebToolHandler;\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;;;;AAQO,MAAM,iBAAiB,CAAC,EAAE,IAAI,EAAE,MAAM,EAAuB;IAClE,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG;IAErC,+DAA+D;IAC/D,MAAM,WAAW;IASjB,4GAA4G;IAC5G,MAAM,eAAe,UAAU,YAAY;IAE3C,MAAM,UAAU;QACd,OAAO,6BAAe,4YAAC,6TAAY;;;;qEAAM,4YAAC,uSAAM;;;;;IAClD;IAEA,MAAM,YAAY,CAAC,cAAc,KAAK;QACpC,MAAM,SAAS,eAAe,gBAAgB;QAC9C,OAAO,cAAc,OAAO,OAAO,CAAC,OAAO,QAAQ;IACrD;IAEA,MAAM,YAAY;QAChB,IAAI,CAAC,UAAU,OAAO;QACtB,OAAO,eAAe,SAAS,GAAG,GAAG,SAAS,KAAK;IACrD;IAEA,OAAQ;QACN,KAAK;YACH,OAAO,WAAW,4BAChB,4YAAC,gJAAS;gBAER,MAAM;gBACN,QAAQ;gBACR,WAAW;eAHN;;;;2DAKL;QAEN,KAAK;YACH,OAAO,WAAW,4BAChB,4YAAC,gJAAS;gBAER,MAAM;gBACN,QAAQ;gBACR,QAAQ;gBACR,WAAW;eAJN;;;;2DAML;QAEN,KAAK;YACH,qBACE,4YAAC,gJAAS;gBAER,MAAM;gBACN,QAAQ,UAAU;gBAClB,QAAQ;eAHH;;;;;QAOX;YACE,OAAO;IACX;AACF;KAjEa;AAoEN,MAAM,uBAAuB"}},
    {"offset": {"line": 869, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/tools/TodoToolHandler.tsx"],"sourcesContent":["import React from \"react\";\nimport { UIMessage } from \"@ai-sdk/react\";\nimport ToolBlock from \"@/components/ui/tool-block\";\nimport { TodoBlock } from \"@/components/ui/todo-block\";\nimport { ListTodo } from \"lucide-react\";\nimport type { ChatStatus, Todo, TodoWriteInput } from \"@/types\";\n\ninterface TodoToolHandlerProps {\n  message: UIMessage;\n  part: any;\n  status: ChatStatus;\n}\n\nexport const TodoToolHandler = ({\n  message,\n  part,\n  status,\n}: TodoToolHandlerProps) => {\n  const { toolCallId, state, input, output } = part;\n  const todoInput = input as TodoWriteInput;\n\n  switch (state) {\n    case \"input-streaming\":\n      return status === \"streaming\" ? (\n        <ToolBlock\n          key={toolCallId}\n          icon={<ListTodo />}\n          action=\"Creating to-do list\"\n          isShimmer={true}\n        />\n      ) : null;\n\n    case \"input-available\":\n      return status === \"streaming\" ? (\n        <ToolBlock\n          key={toolCallId}\n          icon={<ListTodo />}\n          action={\n            todoInput?.merge ? \"Updating to-do list\" : \"Creating to-do list\"\n          }\n          target={`${todoInput?.todos?.length || 0} items`}\n          isShimmer={true}\n        />\n      ) : null;\n\n    case \"output-available\": {\n      const todoOutput = output as {\n        result: string;\n        counts: {\n          completed: number;\n          total: number;\n        };\n        currentTodos: Todo[];\n      };\n\n      return (\n        <TodoBlock\n          todos={todoOutput.currentTodos}\n          inputTodos={todoInput?.todos}\n          blockId={toolCallId}\n          messageId={message.id}\n        />\n      );\n    }\n\n    default:\n      return null;\n  }\n};\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;;;AASO,MAAM,kBAAkB,CAAC,EAC9B,OAAO,EACP,IAAI,EACJ,MAAM,EACe;IACrB,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG;IAC7C,MAAM,YAAY;IAElB,OAAQ;QACN,KAAK;YACH,OAAO,WAAW,4BAChB,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,iTAAQ;;;;;gBACf,QAAO;gBACP,WAAW;eAHN;;;;2DAKL;QAEN,KAAK;YACH,OAAO,WAAW,4BAChB,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,iTAAQ;;;;;gBACf,QACE,WAAW,QAAQ,wBAAwB;gBAE7C,QAAQ,GAAG,WAAW,OAAO,UAAU,EAAE,MAAM,CAAC;gBAChD,WAAW;eANN;;;;2DAQL;QAEN,KAAK;YAAoB;gBACvB,MAAM,aAAa;gBASnB,qBACE,4YAAC,kJAAS;oBACR,OAAO,WAAW,YAAY;oBAC9B,YAAY,WAAW;oBACvB,SAAS;oBACT,WAAW,QAAQ,EAAE;;;;;;YAG3B;QAEA;YACE,OAAO;IACX;AACF;KAvDa"}},
    {"offset": {"line": 942, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/tools/MemoryToolHandler.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport ToolBlock from \"@/components/ui/tool-block\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { Button } from \"@/components/ui/button\";\nimport { NotebookPen } from \"lucide-react\";\nimport type { ChatStatus } from \"@/types\";\n\ninterface MemoryToolHandlerProps {\n  part: any;\n  status: ChatStatus;\n}\n\nexport const MemoryToolHandler = ({ part, status }: MemoryToolHandlerProps) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { toolCallId, state, input, output } = part;\n\n  const memoryInput = (input || {}) as {\n    action?: \"create\" | \"update\" | \"delete\";\n    knowledge_to_store?: string;\n    title?: string;\n    existing_knowledge_id?: string;\n  };\n\n  const getActionText = (action?: string) => {\n    switch (action) {\n      case \"create\":\n        return \"Created memory\";\n      case \"update\":\n        return \"Updated memory\";\n      case \"delete\":\n        return \"Deleted memory\";\n      default:\n        return \"Updated memory\";\n    }\n  };\n\n  const getStreamingActionText = (action?: string) => {\n    switch (action) {\n      case \"create\":\n        return \"Creating memory\";\n      case \"update\":\n        return \"Updating memory\";\n      case \"delete\":\n        return \"Deleting memory\";\n      default:\n        return \"Updating memory\";\n    }\n  };\n\n  const getMemoryContent = () => {\n    // Try to get content from the output first (for completed tool executions)\n    let content = \"\";\n    const title = memoryInput.title;\n\n    // Check if we have output data with memoryContent (tool execution completed)\n    if (output && typeof output === \"object\" && output.memoryContent) {\n      content = output.memoryContent;\n    } else if (\n      part.result &&\n      typeof part.result === \"object\" &&\n      part.result.memoryContent\n    ) {\n      // Fallback to result data\n      content = part.result.memoryContent;\n    } else {\n      // Fallback to input content\n      content = memoryInput.knowledge_to_store || \"No content available\";\n    }\n\n    return (\n      <div className=\"space-y-2 max-h-40 overflow-y-auto\">\n        {title && (\n          <div>\n            <span className=\"font-semibold text-sm text-foreground\">\n              Title:\n            </span>\n            <div className=\"text-sm mt-1 max-h-12 overflow-y-auto\">{title}</div>\n          </div>\n        )}\n        <div className=\"text-sm whitespace-pre-wrap max-h-20 overflow-y-auto leading-relaxed\">\n          {content}\n        </div>\n      </div>\n    );\n  };\n\n  const handleClick = () => {\n    setIsOpen(!isOpen);\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" || e.key === \" \") {\n      e.preventDefault();\n      setIsOpen(!isOpen);\n    }\n  };\n\n  const handleMouseEnter = () => {\n    setIsOpen(true);\n  };\n\n  const handleMouseLeave = () => {\n    setIsOpen(false);\n  };\n\n  switch (state) {\n    case \"input-streaming\":\n      return status === \"streaming\" ? (\n        <ToolBlock\n          key={toolCallId}\n          icon={<NotebookPen />}\n          action={getStreamingActionText(memoryInput.action)}\n          isShimmer={true}\n        />\n      ) : null;\n\n    case \"input-available\":\n      return status === \"streaming\" ? (\n        <ToolBlock\n          key={toolCallId}\n          icon={<NotebookPen />}\n          action={getStreamingActionText(memoryInput.action)}\n          target={memoryInput.title}\n          isShimmer={true}\n        />\n      ) : null;\n\n    case \"output-available\":\n      return (\n        <div className=\"block w-full my-2\">\n          <Popover open={isOpen} onOpenChange={setIsOpen}>\n            <PopoverTrigger asChild>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"h-auto text-muted-foreground hover:text-foreground justify-start w-auto\"\n                onClick={handleClick}\n                onKeyDown={handleKeyDown}\n                onMouseEnter={handleMouseEnter}\n                onMouseLeave={handleMouseLeave}\n              >\n                <NotebookPen className=\"h-4 w-4\" />\n                {getActionText(memoryInput.action)}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent\n              className=\"w-80 max-w-sm\"\n              align=\"start\"\n              sideOffset={8}\n              onMouseEnter={handleMouseEnter}\n              onMouseLeave={handleMouseLeave}\n            >\n              {getMemoryContent()}\n            </PopoverContent>\n          </Popover>\n        </div>\n      );\n\n    default:\n      return null;\n  }\n};\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAKA;AACA;;;;;;;;AAQO,MAAM,oBAAoB,CAAC,EAAE,IAAI,EAAE,MAAM,EAA0B;;IACxE,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,wXAAQ,EAAC;IACrC,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG;IAE7C,MAAM,cAAe,SAAS,CAAC;IAO/B,MAAM,gBAAgB,CAAC;QACrB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,MAAM,yBAAyB,CAAC;QAC9B,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,MAAM,mBAAmB;QACvB,2EAA2E;QAC3E,IAAI,UAAU;QACd,MAAM,QAAQ,YAAY,KAAK;QAE/B,6EAA6E;QAC7E,IAAI,UAAU,OAAO,WAAW,YAAY,OAAO,aAAa,EAAE;YAChE,UAAU,OAAO,aAAa;QAChC,OAAO,IACL,KAAK,MAAM,IACX,OAAO,KAAK,MAAM,KAAK,YACvB,KAAK,MAAM,CAAC,aAAa,EACzB;YACA,0BAA0B;YAC1B,UAAU,KAAK,MAAM,CAAC,aAAa;QACrC,OAAO;YACL,4BAA4B;YAC5B,UAAU,YAAY,kBAAkB,IAAI;QAC9C;QAEA,qBACE,4YAAC;YAAI,WAAU;;gBACZ,uBACC,4YAAC;;sCACC,4YAAC;4BAAK,WAAU;sCAAwC;;;;;;sCAGxD,4YAAC;4BAAI,WAAU;sCAAyC;;;;;;;;;;;;8BAG5D,4YAAC;oBAAI,WAAU;8BACZ;;;;;;;;;;;;IAIT;IAEA,MAAM,cAAc;QAClB,UAAU,CAAC;IACb;IAEA,MAAM,gBAAgB,CAAC;QACrB,IAAI,EAAE,GAAG,KAAK,WAAW,EAAE,GAAG,KAAK,KAAK;YACtC,EAAE,cAAc;YAChB,UAAU,CAAC;QACb;IACF;IAEA,MAAM,mBAAmB;QACvB,UAAU;IACZ;IAEA,MAAM,mBAAmB;QACvB,UAAU;IACZ;IAEA,OAAQ;QACN,KAAK;YACH,OAAO,WAAW,4BAChB,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,0TAAW;;;;;gBAClB,QAAQ,uBAAuB,YAAY,MAAM;gBACjD,WAAW;eAHN;;;;2DAKL;QAEN,KAAK;YACH,OAAO,WAAW,4BAChB,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,0TAAW;;;;;gBAClB,QAAQ,uBAAuB,YAAY,MAAM;gBACjD,QAAQ,YAAY,KAAK;gBACzB,WAAW;eAJN;;;;2DAML;QAEN,KAAK;YACH,qBACE,4YAAC;gBAAI,WAAU;0BACb,cAAA,4YAAC,0IAAO;oBAAC,MAAM;oBAAQ,cAAc;;sCACnC,4YAAC,iJAAc;4BAAC,OAAO;sCACrB,cAAA,4YAAC,wIAAM;gCACL,SAAQ;gCACR,MAAK;gCACL,WAAU;gCACV,SAAS;gCACT,WAAW;gCACX,cAAc;gCACd,cAAc;;kDAEd,4YAAC,0TAAW;wCAAC,WAAU;;;;;;oCACtB,cAAc,YAAY,MAAM;;;;;;;;;;;;sCAGrC,4YAAC,iJAAc;4BACb,WAAU;4BACV,OAAM;4BACN,YAAY;4BACZ,cAAc;4BACd,cAAc;sCAEb;;;;;;;;;;;;;;;;;QAMX;YACE,OAAO;IACX;AACF;GArJa;KAAA"}},
    {"offset": {"line": 1164, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/tools/GetTerminalFilesHandler.tsx"],"sourcesContent":["import React from \"react\";\nimport ToolBlock from \"@/components/ui/tool-block\";\nimport { FileDown } from \"lucide-react\";\nimport type { ChatStatus } from \"@/types/chat\";\n\ninterface TerminalFilesPart {\n  toolCallId: string;\n  state:\n    | \"input-streaming\"\n    | \"input-available\"\n    | \"output-available\"\n    | \"output-error\";\n  input?: { files: string[] };\n  output?: {\n    result: string;\n    files?: Array<{ path: string }>;\n    // Legacy support for old messages\n    fileUrls?: Array<{ path: string; downloadUrl?: string }>;\n  };\n}\n\ninterface GetTerminalFilesHandlerProps {\n  part: TerminalFilesPart;\n  status: ChatStatus;\n}\n\nexport const GetTerminalFilesHandler = ({\n  part,\n  status,\n}: GetTerminalFilesHandlerProps) => {\n  const { toolCallId, state, input, output } = part;\n  const filesInput = input;\n  const filesOutput = output;\n\n  const getFileNames = (paths: string[]) => {\n    return paths.map((path) => path.split(\"/\").pop() || path).join(\", \");\n  };\n\n  switch (state) {\n    case \"input-streaming\":\n      return status === \"streaming\" ? (\n        <ToolBlock\n          key={toolCallId}\n          icon={<FileDown />}\n          action=\"Preparing\"\n          isShimmer={true}\n        />\n      ) : null;\n\n    case \"input-available\":\n      return (\n        <ToolBlock\n          key={toolCallId}\n          icon={<FileDown />}\n          action={status === \"streaming\" ? \"Sharing\" : \"Shared\"}\n          target={getFileNames(filesInput?.files || [])}\n          isShimmer={status === \"streaming\"}\n        />\n      );\n\n    case \"output-available\": {\n      // Support both new (files) and legacy (fileUrls) formats\n      const fileCount =\n        filesOutput?.files?.length || filesOutput?.fileUrls?.length || 0;\n      const fileNames = getFileNames(filesInput?.files || []);\n\n      return (\n        <ToolBlock\n          key={toolCallId}\n          icon={<FileDown />}\n          action={`Shared ${fileCount} file${fileCount !== 1 ? \"s\" : \"\"}`}\n          target={fileNames}\n        />\n      );\n    }\n\n    case \"output-error\":\n      return (\n        <ToolBlock\n          key={toolCallId}\n          icon={<FileDown />}\n          action=\"Failed to share\"\n          target={getFileNames(filesInput?.files || [])}\n        />\n      );\n\n    default:\n      return null;\n  }\n};\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAwBO,MAAM,0BAA0B,CAAC,EACtC,IAAI,EACJ,MAAM,EACuB;IAC7B,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG;IAC7C,MAAM,aAAa;IACnB,MAAM,cAAc;IAEpB,MAAM,eAAe,CAAC;QACpB,OAAO,MAAM,GAAG,CAAC,CAAC,OAAS,KAAK,KAAK,CAAC,KAAK,GAAG,MAAM,MAAM,IAAI,CAAC;IACjE;IAEA,OAAQ;QACN,KAAK;YACH,OAAO,WAAW,4BAChB,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,iTAAQ;;;;;gBACf,QAAO;gBACP,WAAW;eAHN;;;;2DAKL;QAEN,KAAK;YACH,qBACE,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,iTAAQ;;;;;gBACf,QAAQ,WAAW,cAAc,YAAY;gBAC7C,QAAQ,aAAa,YAAY,SAAS,EAAE;gBAC5C,WAAW,WAAW;eAJjB;;;;;QAQX,KAAK;YAAoB;gBACvB,yDAAyD;gBACzD,MAAM,YACJ,aAAa,OAAO,UAAU,aAAa,UAAU,UAAU;gBACjE,MAAM,YAAY,aAAa,YAAY,SAAS,EAAE;gBAEtD,qBACE,4YAAC,gJAAS;oBAER,oBAAM,4YAAC,iTAAQ;;;;;oBACf,QAAQ,CAAC,OAAO,EAAE,UAAU,KAAK,EAAE,cAAc,IAAI,MAAM,IAAI;oBAC/D,QAAQ;mBAHH;;;;;YAMX;QAEA,KAAK;YACH,qBACE,4YAAC,gJAAS;gBAER,oBAAM,4YAAC,iTAAQ;;;;;gBACf,QAAO;gBACP,QAAQ,aAAa,YAAY,SAAS,EAAE;eAHvC;;;;;QAOX;YACE,OAAO;IACX;AACF;KA/Da"}},
    {"offset": {"line": 1258, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/components/tools/SummarizationHandler.tsx"],"sourcesContent":["import { UIMessage } from \"@ai-sdk/react\";\nimport { WandSparkles } from \"lucide-react\";\nimport { Shimmer } from \"@/components/ai-elements/shimmer\";\n\ninterface SummarizationHandlerProps {\n  message: UIMessage;\n  part: any;\n  partIndex: number;\n}\n\nexport const SummarizationHandler = ({\n  message,\n  part,\n  partIndex,\n}: SummarizationHandlerProps) => {\n  return (\n    <div\n      key={`${message.id}-summarization-${partIndex}`}\n      className=\"mb-3 flex items-center gap-2\"\n    >\n      <WandSparkles className=\"w-4 h-4 text-muted-foreground\" />\n      {part.data.status === \"started\" ? (\n        <Shimmer className=\"text-sm\">{`${part.data.message}...`}</Shimmer>\n      ) : (\n        <span className=\"text-sm text-muted-foreground\">\n          {part.data.message}\n        </span>\n      )}\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;AACA;;;;AAQO,MAAM,uBAAuB,CAAC,EACnC,OAAO,EACP,IAAI,EACJ,SAAS,EACiB;IAC1B,qBACE,4YAAC;QAEC,WAAU;;0BAEV,4YAAC,6TAAY;gBAAC,WAAU;;;;;;YACvB,KAAK,IAAI,CAAC,MAAM,KAAK,0BACpB,4YAAC,sJAAO;gBAAC,WAAU;0BAAW,GAAG,KAAK,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC;;;;;yEAEvD,4YAAC;gBAAK,WAAU;0BACb,KAAK,IAAI,CAAC,OAAO;;;;;;;OARjB,GAAG,QAAQ,EAAE,CAAC,eAAe,EAAE,WAAW;;;;;AAarD;KApBa"}}]
}